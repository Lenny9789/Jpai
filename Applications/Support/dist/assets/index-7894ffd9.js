import{C as F,H,D as i,ad as L,E as M,a9 as d,R as t,G as n,w as c,Z as j,_ as q,o as G,W as f,U as T,V as J}from"./index-3dcc8fbd.js";import{v as p}from"./runtime-dom.esm-bundler-65ecdaea.js";import{C as W}from"./index-b73ef6b8.js";import"./index-6f49421e.js";/* empty css              *//* empty css              */import{C as K}from"./index-9cfa08d7.js";import{F as Q}from"./index-8c16716c.js";import{_ as Y}from"./img4-af43059c.js";import{a as m}from"./common-a47fff3e.js";import{s as A}from"./storage-a45bd5c0.js";import{a as k}from"./android_api-ee1231ec.js";import{a as O}from"./axios-213479dd.js";import{F as z}from"./index-cc9a13f4.js";import{B as Z}from"./index-a7ca7fba.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-4ccc55cb.js";import"./index-30732979.js";import"./constant-77ae5ca0.js";import"./use-route-fa97d2d0.js";import"./index-6db50d8f.js";import"./_commonjsHelpers-edff4021.js";import"./mount-component-74e25e35.js";import"./on-popup-reopen-bcee1d9f.js";const S=h=>(j("data-v-08a6ecfa"),h=h(),q(),h),ee={class:"box"},oe=S(()=>t("img",{src:Y,alt:""},null,-1)),te=[oe],se={class:"chang_type"},ae={class:"cord_box"},le=S(()=>t("div",{class:"text_box"},[t("span",null,"欢迎回来")],-1)),ne={class:"inp_box"},re={style:{margin:"16px"}},ie={style:{margin:"16px"}},ce=S(()=>t("span",null,[f("我已阅读并同意："),t("a",{href:""},"用户协议"),f("，"),t("a",{href:""},"个人信息保护指引")],-1)),de={class:"version"},pe=F({__name:"index",setup(h){const g=/^1[1-9]\d{9}$/,y=H(),_=i(!0),b=i(!1),C=i(0),v=i(!1);i(""),i(!0);const a=L({Phone:"",Type:"1",Code:""}),r=L({phoneNumber:"",areaCode:"+86",password:"",code:"",verificationCode:"",accept:!0}),u=i(!1),U=async()=>{u.value=!0,localStorage.setItem("IMAccount",r.phoneNumber);try{await k.call("loginByPassword",JSON.stringify({Phone:r.phoneNumber,Password:r.password}),o=>{if(console.log(o),o.status===200){console.log("success-----"+o);const e=o.imToken,l=o.userID;A(e,e,l)}else m({message:o.msg})})}catch(o){m({message:"登录出错！"})}u.value=!1},D=()=>{y.push("/forgetPassword")},N=()=>{v.value=!v.value},R=async()=>{u.value=!0,localStorage.setItem("IMAccount",a.Phone);try{await k.call("loginOrRegister",JSON.stringify({Phone:a.Phone,Code:a.Code}),o=>{if(console.log(o),o.status===200){const e=o.imToken,l=o.userID;console.log(o),A(e,e,l),o.IsNew==!0&&(O.post("http://www.myjpai.com:10066/api/AB/InitCredit",{UserId:l}),O.post("http://www.myjpai.com:10066/api/AB/InitAcctBalance",{UserId:l}),y.push("/setPassword"))}else m({message:o.msg})})}catch(o){m({message:"登录出错！"})}u.value=!1},B=o=>{y.push({path:"getCode",query:{isRegiste:o+""}})};var x=i(!1),P=i("获取验证码");const E=async()=>{if(/^1[3-9]\d{9}$/.test(a.Phone)){await k.call("sendSms",JSON.stringify({Phone:a.Phone,Type:a.Type}),w=>{w.status===200&&m({message:"获取成功"})});let e=60,l=setInterval(()=>{e==0?(clearInterval(l),P.value="获取验证码",x.value=!1):(P.value=e+"秒后重试",x.value=!0,e--)},1e3)}else m({message:"请正确填写手机号！"})};return(o,e)=>{const l=Q,w=K,I=Z,V=z,$=W;return G(),M("div",ee,[d(t("div",{class:"back",onClick:e[0]||(e[0]=s=>(_.value=!0,C.value=0))},te,512),[[p,!_.value]]),d(t("div",se,[t("button",{onClick:e[1]||(e[1]=s=>(_.value=!1,C.value=1)),class:"button_box"}," 登录 "),t("button",{class:"button_box",onClick:e[2]||(e[2]=s=>B(!0))},"注册")],512),[[p,_.value]]),d(t("div",ae,[le,t("div",ne,[d(n(V,{onSubmit:U},{default:c(()=>[n(w,{inset:""},{default:c(()=>[d(t("div",null,[n(l,{modelValue:r.phoneNumber,"onUpdate:modelValue":e[3]||(e[3]=s=>r.phoneNumber=s),name:"手机号",label:"手机号",placeholder:"手机号",type:"number",rules:[{pattern:g,message:"请填写正确格式的手机号"}],class:"phone_box"},null,8,["modelValue","rules"]),n(l,{modelValue:r.password,"onUpdate:modelValue":e[4]||(e[4]=s=>r.password=s),type:b.value?"text":"password","right-icon":b.value?"closed-eye":"eye",onClickRightIcon:e[5]||(e[5]=s=>b.value=!b.value),name:"密码",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}],class:"password_box"},null,8,["modelValue","type","right-icon"])],512),[[p,v.value==!0]])]),_:1}),t("div",{class:"actions"},[t("div",{class:"action-btn",onClick:D},"忘记密码"),t("div",{class:"action-btn",onClick:N},"验证码登录")]),t("div",re,[n(I,{loading:u.value,disabled:!(g.test(r.phoneNumber)&&r.password),block:"",type:"primary",onClick:U,color:"#c81623",round:""},{default:c(()=>[f(" 登录 ")]),_:1},8,["loading","disabled"])])]),_:1},512),[[p,v.value==!0]]),d(n(V,{onSubmit:R},{default:c(()=>[n(w,{inset:""},{default:c(()=>[n(l,{type:"number",name:"手机号",label:"手机号",placeholder:"手机号",rules:[{pattern:g,message:"请填写正确格式的手机号"}],class:"phone_box",modelValue:a.Phone,"onUpdate:modelValue":e[6]||(e[6]=s=>a.Phone=s)},null,8,["rules","modelValue"]),n(l,{type:"number",center:"",clearable:"",label:"验证码",placeholder:"请输入",modelValue:a.Code,"onUpdate:modelValue":e[7]||(e[7]=s=>a.Code=s)},{button:c(()=>[n(I,{color:"#c81623",size:"small",type:"primary",onClick:E,disabled:T(x)},{default:c(()=>[f(J(T(P)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),t("div",{class:"xh",onClick:N},"密码登录"),t("div",ie,[n(I,{loading:u.value,disabled:!(g.test(a.Phone)&&a.Code),block:"",type:"primary",onClick:R,color:"#c81623",round:""},{default:c(()=>[f(" 登录 ")]),_:1},8,["loading","disabled"])])]),_:1},512),[[p,v.value==!1]])]),n($,{modelValue:r.accept,"onUpdate:modelValue":e[8]||(e[8]=s=>r.accept=s)},{default:c(()=>[ce]),_:1},8,["modelValue"])],512),[[p,C.value==1]]),d(t("div",de," 当前版本:1.0.7 ",512),[[p,_.value]])])}}});const De=X(pe,[["__scopeId","data-v-08a6ecfa"]]);export{De as default};
