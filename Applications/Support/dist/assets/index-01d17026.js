import{C as X,D as o,l as Z,m as tt,E as c,R as t,U as b,V as i,G as m,W as k,F as x,X as j,c as st,w as et,o as n,Y as A,Z as at,_ as ot}from"./index-3dcc8fbd.js";import"./index-6db50d8f.js";/* empty css              */import{R as it}from"./index-56bf55ac.js";import{_ as lt,a as nt,b as ct}from"./ol3-83447a1c.js";import{g as _t,a as dt}from"./storage-a45bd5c0.js";import{r as p}from"./index-ec993ea9.js";import{a as _}from"./axios-213479dd.js";import{a as P}from"./android_api-ee1231ec.js";import{m as rt}from"./okl-b455b91c.js";import{f as mt}from"./common-a47fff3e.js";import{s as pt}from"./function-call-1b368c68.js";import{O as ut}from"./mount-component-74e25e35.js";import{I as vt}from"./index-4ccc55cb.js";import{L as ht}from"./index-30732979.js";import{_ as wt}from"./_plugin-vue_export-helper-c27b6911.js";import"./_commonjsHelpers-edff4021.js";import"./use-refs-a75f9fe4.js";import"./runtime-dom.esm-bundler-65ecdaea.js";import"./Dialog-ab618176.js";import"./index-a7ca7fba.js";import"./use-route-fa97d2d0.js";import"./constant-77ae5ca0.js";import"./use-placeholder-ddc70116.js";import"./on-popup-reopen-bcee1d9f.js";const d=u=>(at("data-v-d6cde6e5"),u=u(),ot(),u),Ut={key:0,class:"shop_box"},gt={class:"set_box"},Lt={class:"user_info"},yt={class:"user_glass"},It={class:"user_img"},Rt=["src"],ft={class:"user_name"},Ot={class:"user_id"},St=d(()=>t("div",null," 预留 ",-1)),Nt={class:"tl_glass"},bt={class:"balance"},At={class:"balance_item"},Pt={class:"balance_icon"},Ct=d(()=>t("div",{class:"icon_text"},"账户余额",-1)),Tt={class:"balance_text"},Et={class:"balance_item"},Ht={class:"balance_icon"},Mt=d(()=>t("div",{class:"icon_text"},"可售金额",-1)),kt={class:"balance_text"},xt={class:"balance_item"},jt={class:"balance_icon"},Vt=d(()=>t("div",{class:"icon_text"},"卖单金额",-1)),Dt={class:"balance_text"},Ft={class:"order"},$t={class:"order_item"},Gt={class:"title"},Bt=d(()=>t("span",null," 在售订单：",-1)),Wt={class:"list_item textel"},qt={class:"list_item"},Yt={class:"list_item"},zt={class:"list_item"},Kt={key:0,src:lt,alt:""},Qt={key:1,src:nt,alt:""},Jt={key:2,src:ct,alt:""},Xt={class:"transaction"},Zt={class:"transaction_cord"},ts={class:"title"},ss=d(()=>t("span",null,"历史订单：",-1)),es={class:"list1"},as={class:"type_box"},os={class:"type_box2"},is={class:"liss"},ls={class:"liss"},ns={class:"list2"},cs=d(()=>t("div",{class:"list3"},[t("span",null,"交易成功")],-1)),_s={class:"loading"},ds=X({__name:"index",setup(u){const U=o(!0),V=_t(),l=dt(),g=o(""),L=o();o();const D=s=>{p.push({path:"/seemore",query:{isRegiste:s+""}})},F=()=>{p.push("/SellList")},v=o(),C=o(),T=o(),E=o(),$=()=>{console.log(0x27797f26d671c8),_.post("http://www.myjpai.com:10066/api/AB/GetListCardNumber",{UserId:l}).then(s=>{C.value=s.data.data,_.post("http://www.myjpai.com:10066/api/AB/GetPayImg",{UserId:l}).then(e=>{T.value=e.data.data.PayPal_Url,E.value=e.data.data.WeChat_Url,C.value&&T.value==""&&E.value==""&&pt({title:"完善支付方式",message:"检测到您的账号还未提供至少一种收款方式，请前往我的——收款方式中添加"}).then(()=>{P.call("jumpActivity",JSON.stringify({activity_name:"paymentMethod"}),O=>{})}).catch(()=>{P.call("jumpActivity",JSON.stringify({activity_name:"chat"}),O=>{})})}).catch(e=>{console.log(e)})}).catch(s=>{console.log(s)})},G=()=>{console.log("触发"),P.call("getUserInfo",JSON.stringify({data:l}),s=>{s.status==200&&(console.log("====================================================="),console.log(s.data),v.value=s.data)})},B=()=>{p.push({path:"add_commodity",query:{Credit:g.value}})},W=()=>{p.push("/Proposition")},y=o(),H=o(),q=()=>{},h=o(),I=o(),w=o(),R=o(0),Y=async()=>{await _.post("http://www.myjpai.com:10066/api/AB/InitCredit",{UserId:l}),await _.post("http://www.myjpai.com:10066/api/AB/InitAcctBalance",{UserId:l})};let M;const f=async()=>{R.value++,await _.post("http://www.myjpai.com:10066/api/User/GetUserMallInfo",{userId:l},{headers:{token:V}}).then(s=>{M=Object.keys(s.data.data).length,Object.keys(s.data.data).length<1&&R.value<=3&&(Y(),f()),h.value=Number(s.data.data.AcctBalance)+Number(s.data.data.OrderSaleSum),w.value=Number(s.data.data.OrderSaleSum),I.value=h.value-w.value,g.value=s.data.data.Credit,L.value=Number(g.value)/100}).catch(s=>{console.log(s)})},z=async s=>{await _.post("http://www.myjpai.com:10066/api/Order/GetUserOrderInfo",{userId:l,order_state:Number(s),page:1,pageSize:3,sortord:11}).then(e=>{console.log(e.data),Number(s)==0?y.value=e.data.data.slice(0,3):H.value=e.data.data.slice(0,3)}).catch(e=>{console.log(e)})},K=async()=>{await _.post("http://www.myjpai.com:10066/api/Order/SaveOrederCashFlow",{userId:l,page:1,pageSize:3}).then(s=>{y.value=s.data.data})};let r;return Z(async()=>{r=setInterval(()=>{M<1?(console.log("尝试初始化商城"),R.value=0,f()):(clearInterval(r),r=null)},1e4),await f(),await z("1"),await K(),await G(),await $(),U.value=!1,window.localStorage.getItem("buyingId")&&window.localStorage.getItem("buyingUId")==l&&p.push({path:"BuyerOrder",query:{orderId:window.localStorage.getItem("buyingId")}})}),tt(()=>{clearInterval(r),r=null}),(s,e)=>{const O=it,S=vt,Q=ht,J=ut;return U.value?(n(),st(J,{key:1,show:U.value,"z-index":"99"},{default:et(()=>[t("div",_s,[m(Q,{color:"#fff"})])]),_:1},8,["show"])):(n(),c("div",Ut,[t("div",gt,[t("div",Lt,[t("div",yt,[t("div",It,[t("img",{src:v.value.FaceURL?v.value.FaceURL:b(rt),alt:""},null,8,Rt)]),t("div",null,[t("div",ft,i(v.value.NickName),1),t("div",Ot,"ID："+i(b(l)),1),t("div",null,[m(O,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=a=>L.value=a),readonly:"",size:20,color:"#ffd21e","void-icon":"star","void-color":"#eee"},null,8,["modelValue"])]),St])])]),t("div",Nt,[t("div",bt,[t("div",At,[t("div",Pt,[t("div",null,[m(S,{name:"user-circle-o",size:"30",color:"white"})]),Ct,t("div",Tt,"$"+i(h.value?h.value:0),1)])]),t("div",Et,[t("div",Ht,[t("div",null,[m(S,{name:"after-sale",size:"30",color:"white"})]),Mt,t("div",kt,"$"+i(I.value?I.value:0),1)])]),t("div",xt,[t("div",jt,[t("div",null,[m(S,{name:"cash-o",size:"30",color:"white"})]),Vt,t("div",Dt,"$"+i(w.value?w.value:0),1)])])]),t("div",{class:"btn"},[t("button",{onClick:B},"出售"),t("button",{onClick:W},"购买")])]),t("div",Ft,[t("div",$t,[t("div",Gt,[Bt,k(),t("span",{class:"title_btn",onClick:e[1]||(e[1]=a=>F())},"展示更多>")]),(n(!0),c(x,null,j(H.value,(a,N)=>(n(),c("div",{class:"order_list",key:N},[t("div",Wt,i(a.OrderId),1),t("div",qt,"￥"+i(a.Sum),1),t("div",Yt,i(`${a.SellStatus==1?"可拆售":"不可拆售"}`),1),t("div",zt,[a.PayPal==1?(n(),c("img",Kt)):A("",!0),a.WeChat==1?(n(),c("img",Qt)):A("",!0),a.UnionPay==1?(n(),c("img",Jt)):A("",!0)])]))),128))])]),t("div",Xt,[t("div",Zt,[t("div",ts,[ss,k(),t("span",{class:"title_btn",onClick:e[2]||(e[2]=a=>D(!1))},"展示更多>")]),(n(!0),c(x,null,j(y.value,(a,N)=>(n(),c("div",{class:"transaction_list",key:N,onClick:q},[t("div",es,[t("div",as,i(a.CashFlowState==1?"买":"卖"),1),t("div",os,[t("div",is,"订单号："+i(a.OrderId),1),t("div",ls,i(b(mt)(a.TradingHour)),1)])]),t("div",ns,[t("span",null,"￥"+i(Number(a.IncomingAmount)),1)]),cs]))),128))])])])]))}}});const ks=wt(ds,[["__scopeId","data-v-d6cde6e5"]]);export{ks as default};
